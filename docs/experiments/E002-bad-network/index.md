---
id: E002
title: "Влияние сетевой задержки на I/O при использовании USB/IP"
type: experiment
system: usbip
status: done
date: 2026-01-09
tags: [experiment, usbip, latency, io]
---

# Влияние сетевой задержки на I/O при использовании USB/IP

## Цель
Экспериментально исследовать влияние деградации сетевых условий (увеличения задержки) на производительность, латентность и стабильность ввода-вывода при использовании USB/IP для удалённого доступа к USB-накопителю.

## Гипотеза
Если сетовая задержка увеличивается, то USB/IP, использующий TCP и синхронные kernel-space I/O пути, демонстрирует:
- резкое снижение I/O производительности,
- рост хвостовых задержек (p99 и выше),
- появление backpressure и блокирующих состояний,
что делает систему фактически непригодной для практического использования.

## Конфигурация стенда
- **Сервер**: Linux-хост с физически подключённым USB-накопителем
- **Клиент**: Linux-хост с модулем `vhci_hcd`
- **Устройство**: USB Flash Drive (~32 ГБ)
- **Сеть**: контролируемая L2 Ethernet-сеть
- **ПО**: USB/IP (in-kernel), fio, tc/netem

## Методика
См. [[steps]].

## Результаты
См. [[results]].

## Артефакты
См. [[artifacts]].

## Вывод
1. Производительность USB/IP жёстко зависит от сетевой задержки.
2. При росте RTT хвостовые задержки достигают секунд.
3. Система остаётся функциональной, но становится практически непригодной для работы.

## Риски и ограничения
- Используется файловая система vfat.
- `iodepth=1` не отражает максимальную пропускную способность.
- Packet loss и jitter не моделировались.

## Связь с USB-over-QUIC
Эксперимент выявляет архитектурные ограничения USB/IP (RTT-bound поведение, отсутствие graceful degradation), которые предполагается устранить в реализации USB-over-QUIC за счёт асинхронности, мультиплексирования потоков и более гибкого управления перегрузкой.
